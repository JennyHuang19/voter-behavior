---
title: "Written Report Draft"
author: "Approximately Normal: Jenny Huang, Bella Larsen, Jessie Bierschenk, Aidan Gildea"
date: "17 November 2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE)
```

```{r load-packages, message=FALSE}
library(tidyverse)
library(broom)
library(patchwork)
library(RColorBrewer)
library(ggthemes)
library(viridis)
library(skimr)
```

```{r data}
elections <- read_csv("data/data_full.csv")
```

```{r data cleaning}
elections_clean <- elections %>% 
  mutate(metro = if_else(METRO == 2, "Metro", "Not Metro/Unknown")) %>% 
  mutate(sex = case_when(SEX == 1 ~ "Male",
                         SEX == 2 ~ "Female")) %>% 
  mutate(marst = case_when(MARST == 1 ~ "Married",
                           MARST == 2 ~ "Married",
                           MARST == 4 ~ "Divorced/Separated",
                           MARST == 3 ~ "Divorced/Separated",
                           TRUE ~ "Not Married/Other")) %>% 
  mutate(veteran = if_else(VETSTAT == 2, "Yes", "No/Uknnown")) %>% 
  mutate(citizen = case_when(CITIZEN == 5 | CITIZEN == 9 ~ "No/Unknown", 
                             CITIZEN == 1 | CITIZEN == 2 | CITIZEN == 3 ~ 
                               "Native Born",
                             CITIZEN == 4 ~ "Naturalized")) %>% 
  #We should probably exclude people who are not citizens from our analysis 
  #because they are not able to vote
  mutate(hispanic_status = if_else(HISPAN == 0 | HISPAN == 901 | HISPAN == 902, 
                             "Not Hispanic/Unknown", "Hispanic/Latinx")) %>% 
  mutate(employed = if_else(LABFORCE == 2, "Yes", "No/Unknown")) %>% 
  mutate(highest_education = case_when(EDUC99 == 0 | EDUC99 == 1 ~ 
                                         "None/Unknown",
                               EDUC99 == 4 | EDUC99 == 5 | EDUC99 == 6 |
                                 EDUC99 == 7 | EDUC99 == 8 | EDUC99 == 9
                               ~ "Some High School",
                               EDUC99 == 10 ~ "High School Degree/GED",
                               EDUC99 == 11 ~ "Some College",
                               EDUC99 == 12 | EDUC99 == 13 | EDUC99 == 14
                               ~ "Associate Degree",
                               EDUC99 == 15 ~ "Bachelors Degree",
                               EDUC99 == 16 ~ "Masters Degree",
                               EDUC99 == 17 ~ "Professional Degree",
                               EDUC99 == 18 ~ "Doctorate Degree")) %>% 
  mutate(current_student = case_when(SCHLCOLL == 5 | SCHLCOLL == 0 ~ 
                                       "Not currently enrolled",
                                     SCHLCOLL == 1  ~ "High School Full Time",
                                     SCHLCOLL == 2 ~ "High School Part Time",
                                     SCHLCOLL == 3 ~ "College Full Time",
                                     SCHLCOLL == 4 ~ "College Part Time")) %>% 
#of people 16-24
  mutate(race = case_when(RACE == 820 | RACE == 830 | RACE == 830 | RACE == 819 
                          | RACE == 804 | RACE == 805 | RACE == 806 | 
                            RACE == 807 | RACE == 808 | RACE == 810 | 
                            RACE == 811 | RACE == 812 | RACE == 813 | 
                            RACE == 814 | RACE == 815 | RACE == 816 | 
                            RACE == 817 | RACE == 818 | RACE == 803 | 
                            RACE == 801 | RACE == 802 | RACE == 830 ~ 
                            "2 or more races",
                          RACE == 100 ~ "White",
                          RACE == 200 ~ "Black",
                          RACE == 651 | RACE == 809 | RACE == 652 | RACE == 650
                          ~ "Asian or Pacific Islander",
                          RACE ==  300 ~ "Native American",
                          RACE == 999 | RACE == 700 ~ "Other/Unknown")) %>% 
  #Need to go over these race categorizations as a group!
  mutate(why_not_vote = case_when(VOWHYNOT == 10 ~ "Inconvenience",
                                  VOWHYNOT == 4 ~ "Interest",
                                  VOWHYNOT == 7 ~ "Political",
                                  VOWHYNOT == 9 | VOWHYNOT ==  6 | 
                                    VOWHYNOT == 5 | VOWHYNOT == 2 ~ 
                                    "Logistical",
                                  VOWHYNOT == 1 ~ "Physically Unable",
                                  VOWHYNOT == 8 ~ "Registration Issues",
                                  VOWHYNOT == 3 ~ "Forgot")) %>% 
#Reason why eligible voter did not vote
  mutate(why_not_reg = case_when(VOYNOTREG == 8 | VOYNOTREG == 3 ~ 
                                   "Not Eligible",
                                 VOYNOTREG == 7 | VOYNOTREG == 6 ~ 
                                   "Not Interested/Vote Won't Matter",
                                 VOYNOTREG == 5 ~ "Language Barrier",
                                 VOYNOTREG == 4 ~ "Physically Unable",
                                 VOYNOTREG == 2 | VOYNOTREG == 1 ~ 
                                   "Lacked Info/Missed Deadline")) %>% 
  mutate(voting_method = case_when(VOTEHOW == 1 ~ "In Person",
                                   VOTEHOW == 2 ~ "Mail-In")) %>% 
  mutate(voting_time = case_when(VOTEWHEN == 2 ~ "Early",
                                 VOTEWHEN == 1 ~"Voting Day")) %>% 
  mutate(voted = case_when(VOTED == 1 ~ 0,
                           VOTED == 2 ~ 1)) %>% 
  mutate(registered = case_when(VOREG == 1 ~ 0,
                           VOREG == 2 ~ 1)) %>% 
  mutate(how_registered = case_when(VOREGHOW == 8 ~ "Online",
                                    VOREGHOW == 7 ~ "Polling Place",
                                    VOREGHOW == 6 ~ "Registration Drive",
                                    VOREGHOW == 5 | VOREGHOW == 2 | 
                                      VOREGHOW == 1 ~ 
                                      "Govt Office/Public Agency",
                                    VOREGHOW == 4 ~ "School/College/Hospital",
                                    VOREGHOW == 3 ~ "By Mail")) %>% 
  mutate(Presidential_Election_Status = case_when(YEAR %in% c(2004, 2008, 
                                                          2012, 2016) ~ 
                                                    "Presidential",
                                                  YEAR %in% c(2006, 2014) ~ 
                                       "Midterm Following Incumbent President",
                                          YEAR %in% c(2010, 2018) ~ 
                                          "Midterm Following New President"),
         Presidential_Election_Status = factor(Presidential_Election_Status)) %>% 
    mutate(Is_Presidential_Election = case_when(YEAR %in% c(2004, 2008, 
                                                          2012, 2016) ~ 
                                                    "Presidential",
                                                  YEAR %in% c(2006, 2010, 2014, 
                                                              2018) ~ 
                                       "Non-Presidential"),
         Is_Presidential_Election = factor(Is_Presidential_Election)) %>% 
  select(metro, sex, marst, veteran, citizen, hispanic_status, employed, 
         highest_education, current_student, race, why_not_vote, why_not_reg,
         voting_method, voting_time, voted, registered, how_registered, YEAR,
         STATEFIP, AGE, Presidential_Election_Status, Is_Presidential_Election)

elections_clean <- elections_clean %>% 
  mutate(metro = factor(metro),
         sex = factor (sex),
         marst = factor(marst),
         veteran = factor(veteran),
         citizen = factor(citizen),
         hispanic_status = factor( hispanic_status),
         employed = factor(employed),
         highest_education = factor(highest_education),
         current_student = factor(current_student),
         race = factor(race),
         why_not_vote = factor(why_not_vote),
         why_not_reg = factor(why_not_reg),
         voting_method = factor(voting_method),
         voting_time = factor(voting_time),
         voted = factor(voted),
         registered = factor(registered),
         how_registered = factor(how_registered))

```

```{r relevel-factors}
elections_clean <- elections_clean %>% 
  mutate(marst = fct_relevel(marst, c("Married", "Divorced/Separated", 
                                      "Not Married/Other")),
         citizen = fct_relevel(citizen, c("Native Born", "Naturalized", 
                                      "No/Unknown")),
         highest_education = fct_relevel(highest_education, 
                                         c("Bachelors Degree", 
                                           "High School Degree/GED",
                                           "Some College",
                                           "Some High School", 
                                           "Associate Degree",
                                           "Masters Degree",
                                           "Professional Degree",
                                           "Doctorate Degree",
                                           "None/Unknown")),
         current_student = fct_relevel(current_student, 
                                       c("Not currently enrolled",
                                         "High School Full Time", 
                                         "High School Part Time",
                                         "College Full Time", 
                                         "College Part Time")),
         race = fct_relevel(race, c("White","Black","Asian or Pacific Islander", 
                                    "Native American", "2 or more races", 
                                    "Other/Unknown")),
         Presidential_Election_Status = fct_relevel(Presidential_Election_Status, 
                    c("Presidential", "Midterm Following Incumbent President", 
                                      "Midterm Following New President")))
```

### Introduction

We will begin our EDA by visualizing the relationship between the response variable describing whether or not someone voted and several of the other variables of particular interest.

We will begin by simply looking at the distribution of those who voted throughout the last 8 years of elections.


```{r EDA, fig.height=3, fig.width=5}
response_plot <- ggplot(data = elections_clean, aes(x = voted, 
                                                    fill = "gainsboro")) +
  geom_bar() +
  theme_bw() +
  # see theme code inspiration at reference 1 
  theme(plot.title= element_text(face="bold", color = "Navy Blue"),
        plot.subtitle = element_text(face = 4, color = "grey54"),
        panel.grid.major = element_line(color = "Navy Blue", size=.1),
        legend.position = "none") +
  # see scale fill code inspiration at reference 2
  scale_fill_manual(values = c("gainsboro")) +
  labs(title = "Visualizing the Distribution of Voting Status", y = "Count",
       x = "Voted", subtitle = "More people reportedly voted than did not vote",
       caption = "0 = Did not Vote, 1 = Voted")
response_plot
```

*see theme code inspiration at reference [1]*
*see scale fill code inspiration at reference [2]*

From the barplot above, it is clear the more individuals in the data set voted (voted = 1) than did not (voted = 0).

As college students ourselves, we want to analyze whether or not being a student influences the frequency of voting. We will explore this preliminarily by visualizing the distribution of if school aged individuals (18-24) voted or not -- categorized by their current student level. This is seen in the bar plot below.

```{r EDA1, fig.height=4, fig.width=6}
EDA1 <- elections_clean %>% 
  ggplot(aes(x = voted, fill = current_student)) +
  geom_bar() +
  theme_bw() +
  theme(plot.title= element_text(face="bold", color = "Navy Blue"),
        plot.subtitle = element_text(face = 4, color = "grey54"),
        panel.grid.major = element_line(color = "Navy Blue", size=.1))+
  #see scale fill brewer code inspiration from reference 1
  scale_fill_brewer(palette = "Blues") +
  labs(title = "Voting Distribution of Population of 16-24 Year Olds", 
       y = "Count", x = "Voted", 
       subtitle = "Examining relationship between student status and voting",
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Current Student Status")
EDA1
```

*see scale fill brewer code inspiration from reference [1]*

From the bar plot, it is evident that a majority of these individuals were not currently enrolled. This may be a result of a general national trend, but we want to investigate if it is the result of a larger proportion of older individuals within in the range of ages between 16-24. We will investigate this by analyzing those who are not currently enrolled in school within this age range.

```{r age-distribution-college-aged}
elections_clean %>%
  filter(current_student == "Not currently enrolled") %>%
  filter(AGE >=16 & AGE <=24) %>%
  group_by(AGE) %>%
  count()  %>% 
  ungroup() %>%
  mutate(prop = n/sum(n)) %>%
  kable(digits = 3)
```

From the table above, it is apparent that more than 40% of those not currently enrolled in school are 23-24 years old. This could be a potential reason for why this age range includes so many who are not currently enrolled as a student. 

To more meaningfully analyze the relationship between being a student and if they vote or not, we adjusted our visualization to only include those currently enrolled in some level of education. This is seen in the visualization below. 

```{r EDA2, fig.height=4, fig.width=6}
EDA2 <- elections_clean %>% 
  filter(current_student != "Not currently enrolled") %>% 
  ggplot(aes(x = voted, fill = current_student)) +
  geom_bar() +
  theme_bw() +
    theme(plot.title= element_text(face="bold", color = "Navy Blue"),
        plot.subtitle = element_text(face = 4, color = "grey54"),
        panel.grid.major = element_line(color = "Navy Blue", size=.1))+
  scale_fill_brewer(palette="Blues") +
  labs(title = "Voting Distribution of Population of 16-24 Year Olds 
Enrolled in School", 
       y = "Count", x = "Voted", 
       subtitle = "Examining relationship between student status and voting",
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Current Student Status")
EDA2
```

This visualization shows that eligible voters between the age 16-24 enrolled in some education at the time were mainly full time college students. More full time and part time college students that were eligible to vote did vote compared to those that did not vote. The opposite is true for high school students: more full time and part time high school students that were eligible to vote did not vote compared to those that did vote. 

```{r EDA3, fig.height=4.3, fig.width=6}
citizen_plot <- elections_clean %>% 
  group_by(citizen) %>% 
  count(voted) %>% 
  mutate(total = sum(n)) %>% 
  mutate(prop = n/total) %>% 
  mutate(prop = round(prop, 3))
citizen_plot %>% 
  ggplot(aes(x = voted, y = prop, fill = citizen)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = prop), vjust = -0.05) + 
  #see geom_text() code inspiration in reference [4]*
  facet_grid(cols = vars(citizen))+
  scale_fill_brewer(palette = "Blues") +
  labs(title = "Voting distribution based on citizenship status", 
       y = "Proportion", x = "Voted", 
     subtitle = "Examining relationship between citizenship status and voting",
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Citizenship Status") +
  theme_bw()
```

*see geom_text() code inspiration in reference [4]*

This visualization shows that for both native born and naturalized individuals, more citizens that were eligible to vote did vote compared to those that did not vote; however, the proportion is much greater for native born citizens than for naturalized.

```{r EDA4, fig.height=3, fig.width=5}
elections_clean %>% 
  ggplot(aes(x = AGE, y = voted)) +
  geom_boxplot(fill = "gray") +
  coord_flip() +
  labs(title = "Relationship between age and voting", 
       y = "Voting Status", x = "Age", 
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Citizenship Status")+
  theme_bw()

```

This box plot shows that eligible voters that did vote were generally older than eligible voters that did not vote.

```{r EDA5, fig.height=4.3, fig.width=6}
veteran_plot <- elections_clean %>% 
  group_by(veteran) %>% 
  count(voted) %>% 
  mutate(total = sum(n)) %>% 
  mutate(prop = n/total) %>% 
  mutate(prop = round(prop, 3))
veteran_plot %>% 
  ggplot(aes(x = voted, y = prop, fill = veteran)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = prop), vjust = -0.05) +
  #see geom_text() code inspiration in reference [4]*
  facet_grid(cols = vars(veteran))+
  scale_fill_brewer(palette = "Blues") +
  labs(title = "Voting distribution based on veteran status", 
       y = "Proportion", x = "Voted", 
     subtitle = "Examining relationship between veteran status and voting",
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Veteran Status") +
  theme_bw()
```

*see geom_text() code inspiration in reference [4]*

We are also interested in looking at how voter turnout has changed over the
years.

```{r year-voting-frequency}
elections_year <- elections_clean %>% 
  group_by(YEAR) %>% 
  count(voted) %>% 
  mutate(prop_voted = n/sum(n))
```

We notice that the proportion of people who voted fluctuates depending on
whether the year falls on a presidential election. In the trend of the 
proportion of voting over time, we see a clear divide between the years when
there is a presidential elections versus when there is not. In the future, we 
may decide to add the variable "Election Year" as an interaction term with year
as a divide between years that fall on an election.

```{r EDA6, fig.height=3, fig.width=4.5}
elections_year %>% 
  filter(voted == 1) %>% 
  ggplot(aes(x = YEAR, y = prop_voted)) +
  geom_point() +
  labs(title = "Visualizing Proportion of Voters Over Time", 
       y = "Proportion of People Who Voted", x = "Year")
```

We decided to look at the scatterplot of voter turnout over time broken down by the status of the election (Presidential election, midterm after incumbent president, or midterm after new president) to see how it may differ depending on the election.

```{r scatterplot-over-time, fig.height=4, fig.width=6.5}
elections_year %>% 
  mutate(Presidential_Election_Status = case_when(YEAR %in% c(2004, 2008, 
                                                          2012, 2016) ~ 
                                                    "Presidential",
                                                  YEAR %in% c(2006, 2014) ~ 
                                       "Midterm Following Incumbent President",
                                          YEAR %in% c(2010, 2018) ~ 
                                          "Midterm Following New President"),
        Presidential_Election_Status = factor(Presidential_Election_Status)) %>% 
  filter(voted == 1) %>% 
  ggplot(aes(x = YEAR, y = prop_voted, color = Presidential_Election_Status)) +
  geom_point() +
  labs(title = "Higher Proportion of Voters During Presidential Election Years", 
       y = "Proportion of People Who Voted", x = "Year", 
       color = "Presidential Election Year", caption = "1: Yes; 0: No")
```

From the above scatterplot, we confirmed that there is higher voter turnout during presidential elections compared to midterm elections. In addition, there is equal or higher voter turnout for midterm elections following the election of a new president compared to midterm elections following the election of an incumbent president, and an especially high voter turnout in the midterm election after Trump's election in 2016.

Finally, it is important to acknowledge that our any missingness in our data, as it may influence the outcome of our regression analysis.



### Model Selection 

##Select a random subset of the data to create model.

In order to make our model, we have decided to take a random sample of 10,000 to be sure that the model selection is accurate.

```{r random-sample, message = FALSE}
set.seed(6687) 
elections_red <- elections_clean %>%
  sample_n(10000)
```

```{r backward-selection, include=FALSE}
int_only_model <- glm(voted ~ 1,
                     data = elections_red,
                      family = "binomial")

full_model <- glm(voted ~ metro + sex + marst + veteran+ citizen + 
                   hispanic_status + employed + highest_education + 
                   current_student + race + AGE + Presidential_Election_Status
                 + YEAR,
                     data = elections_red,
                      family = "binomial")

best_model <- step(full_model, scope=formula(int_only_model), 
                   direction = "backward")

```

```{r tidy model}
tidy(best_model) %>% 
  kable(digits = 3)
```

The final model included YEAR + sex + current_student + citizen + employed + race + 
marst + Presidential_Election_Status + AGE + highest_education. 

The final model is: 


The backward selection based on AIC took out the variables metro, veteran, and hispanic_status.

Interpretation of coefficients of interest:

Baseline: Female, married, native born, not employed, Bachelors Degree is highest education, not currently enrolled in school if between the age of 16-24, white, and the time of voting is midterm following the election of an incumbent president.


We expect the odds of an eligible voter voting for a divorced/separated eligible voter to be 0.50 (exp(-0.702)) times the odds of individuals that are female, married, native born, not employed, have Bachelors Degree as their highest education,  not currently enrolled in school if between the age of 16-24, white, and the election is a midterm election following the election of an incumbent president, after factoring in all other voter characteristics/information. 

For each additional year in age, we expect the odds of an eligible voter voting  to be 1.04 (exp(0.040)) times the odds of individuals that are female, married, native born, not employed, have Bachelors Degree as their highest education,  not currently enrolled in school if between the age of 16-24, white, and the election is a midterm election following the election of an incumbent president, after factoring in all other voter characteristics/information. 

We expect the odds of an eligible voter voting when it is a presidential election year to be 2.689 (exp(0.989)) times the odds of individuals that are female, married, native born, not employed, have Bachelors Degree as their highest education,  not currently enrolled in school if between the age of 16-24, white, and the election is a midterm election following the election of an incumbent president, after factoring in all other voter characteristics/information. 

### Checking Model Conditions 

#Linearity

```{r model-conditions-1}
elections_red %>%
  count(sex, voted) %>%
  group_by(sex) %>%
  mutate(prop = n/sum(n)) %>%
  filter(voted == "1") %>%
  mutate(emp_logit = log(prop/(1-prop))) %>% 
  kable()

elections_red %>%
  count(marst, voted) %>%
  group_by(marst) %>%
  mutate(prop = n/sum(n)) %>%
  filter(voted == "1") %>%
  mutate(emp_logit = log(prop/(1-prop))) %>% 
  kable()
```

According to the plot below, there is a linear relationship between the
empirical logit and the predictor variable age. Hence linearity is satisfied 
for AGE.

```{r logit, fig.height=4, fig.width=6}
library(Stat2Data)
emplogitplot1(voted ~ AGE, data = elections_red, 
              ngroups = 10)
```

## Randomness
It is possible that randomness is not satisfied because our data is
from the census survey, which may not be random (ie might select for people who
have time to fill it out). However, there is no reason to believe that this will not generalize to the US population as a whole in a significant way, particularly due to the large sample size.

## Independence
Independence may be violated because geographic location may
influence voting due to factors such as (residuals by state ID). Hence, we will
look at misclassification rate by region.

```{r fip-new}
library(maps)
data(state.fips)
joined_fips <- left_join(elections_red, state.fips, by = c("STATEFIP" = "fips"))
```

```{r augment}
model_aug <- augment(best_model, type.predict = "response") #probability
```

Here, we create a confusion matrix with a misclassification rate of 0.5.

```{r predicted}
model_aug <- model_aug %>% 
  mutate(predicted_voted = if_else(.fitted > 0.5, "Will Vote", "Will Not Vote"))
```

We will left join with region to look at misclassification rates by region.

```{r join}
tojoin <- joined_fips %>% 
  select(AGE, region)

aug_fips <- left_join(model_aug, tojoin, by ="AGE")
```

Below are the misclassification rates by region.
```{r misclassification-rates-by-region}
aug_fips <- aug_fips %>% 
  mutate(region = case_when(region == 1 ~ "Northeast",
                            region == 2 ~ "Midwest",
                            region == 3 ~ "South",
                            region == 4 ~ "West"))
# used Census data for the region fips number corresponding to region name [3]

missclassification <- aug_fips %>% 
  group_by(region) %>% 
  count(voted, predicted_voted) %>%  
  #all combs of responses specified as arguments
  mutate(prop = n / sum(n)) %>% 
  filter(voted == 1 & predicted_voted == "Will Not Vote" | 
        voted == 0 & predicted_voted == "Will Vote")
missclassification %>% 
  kable()
```

*Consulted Census data for the region fips number corresponding to region name [3]*

We plan to create a plot of misclassification rate by region to determine if 
independence is satisfied.

```{r boxplot-misclassification}
aug_fips %>% 
  group_by(region) %>% 
  count(voted, predicted_voted) %>% 
  #all combs of responses specified as arguments
  ggplot(aes(x = predicted_voted, y = n, color = region)) +
  geom_boxplot()
```

Based on the misclassification rates, we have no reason to believe that the independence condition is not satisfied. The misclassification rates across regions are relatively similar, which suggests that there is not an issue of spatial correlation and that the independence condition is satisfied.

## Checking for influential points

```{r obs-num}
best_aug <- augment(best_model) %>%
   mutate(obs_num = row_number()) #add row number to help with graphing
```

## Cook's distance
We will also look for influential points using Cook's Distance.

```{r Cooks-D, fig.height=3, fig.width=6}
## scatterplot of Cook's D vs. observation number
ggplot(data = best_aug, aes(x = obs_num, y = .cooksd)) +
  geom_point(alpha = 0.7) +
  geom_hline(yintercept = c(0.5,1), color = "red", lty = 2) +
  labs(x = "Observation Number", y = "Cook's D") +
  geom_text(aes(label = ifelse(.hat > 0.5,
                           as.character(obs_num), "")), nudge_x = 1)
```

According to Cook's Distance, there are no influential points, so all points can be left in the model.

## Multicollinearity

VIF:

```{r VIF}
# load rms package and calculate VIF
library(rms)
vif(best_model) %>% 
  tidy() %>% 
  arrange(x) %>% 
  kable(digits = 3)
```

All of the VIF values are under the threshold of 10, indicating that there is no evidence of multicollinearity in our data.


### Interaction Terms

We will add in several interaction terms of interest to us and use a drop-in-deviance test to see if they are meaningful predictors of the odds of someone voting.

The following hypotheses will be used:

$H_0$: coefficients for the interaction between sex and employment, presidential election status and highest education level, age and presidential election status, sex and presidential election status, and race and presidential election status are all zero

$$H_0: \beta_{sex*employed} = \\
\beta_{Presidential_Election_Status*highest_education} = \\
\beta_{AGE*Presidential_Election_Status} = \\
\beta_{sex*Presidential_Election_Status} = \\
\beta_{race*Presidential_Election_Status} = 0$$
$H_a$: at least one of these coefficients for the interaction terms $\neq$ zero

$\alpha = 0.05$

```{r interaction}
reduced_model <- best_model

full_model <- glm(voted ~ YEAR + sex + current_student + citizen + employed + 
                    race + marst + Presidential_Election_Status + AGE + 
                    highest_education +
                    Presidential_Election_Status*highest_education + 
                    AGE*Presidential_Election_Status + 
                    sex*Presidential_Election_Status + 
                    race*Presidential_Election_Status,
                     data = elections_red,
                      family = "binomial")
tidy(full_model) %>% 
  kable(digits = 3)
```


```{r drop-in-deviance1}
anova(reduced_model, full_model, test = "Chisq") %>%
  tidy() %>% 
  kable(digits = 3)
```

The p-value (7.840e-07) is very small (less than the alpha level 0.05), 
so we can reject the null hypothesis. Thus, we conclude that the data provide 
sufficient evidence that the coefficients associated with the additional 
interaction terms are not equal to 0. Therefore, we should add them to the model.

Significant interaction terms:
The effect of the election being a presidential election for an individual with
the highest level of education as a High School Degree/GED is significant with
a p-value of 0.011 assuming an alpha level of 0.05. The coefficient is negative,
indicating that this effect would mean that during a presidential election for
an individual with the highest level of education as a High School Degree/GED,
they are less likely to vote than individuals that are female, married, native
born, not employed, have Bachelors Degree as their highest education, 
not currently enrolled in school if between the age of 16-24, white, and 
the election is a midterm election following the election of an incumbent 
president.

The effect of the election being a presidential election for an individual that
is Black is significant with a p-value of 0.013 assuming an alpha level of 0.05.
The coefficient is positive, indicating that this effect would mean that during
a presidential election for an individual that is Black, they are more likely to
vote than individuals that are female, married, native born, not employed, have
Bachelors Degree as their highest education,  not currently enrolled in school
if between the age of 16-24, white, and the election is a midterm election
following the election of an incumbent president


```{r resulting-model}
reduced_model <- best_model

full_model <- glm(voted ~ YEAR + sex + current_student + citizen + employed + 
                    race + marst + Is_Presidential_Election + AGE + 
                    highest_education +
                    Presidential_Election_Status*highest_education + 
                    AGE*Presidential_Election_Status + 
                    sex*Presidential_Election_Status + 
                    race*Presidential_Election_Status,
                     data = elections_red,
                      family = "binomial")
```

We will use a drop-in-deviance test to determine whether or not sex is a 
meaningful variable in the model. 

```{r model-with-sex}
sex_included <- best_model

sex_excluded <- glm(voted ~ YEAR + current_student + citizen + employed + 
                    race + marst + Presidential_Election_Status + AGE + 
                    highest_education,
                     data = elections_red,
                      family = "binomial")
```


```{r drop-in-deviance2}
anova(sex_excluded, sex_included, test = "Chisq") %>%
  tidy() %>% 
  kable(digits = 3)
```
From the drop-in-deviance test to include variable sex, the p-value is greater
than an alpha-level of 0.10, so we will exclude sex from the model. This contradicts the model output from the backward selection, which is most likely due their different criteria for statistical significance. Backward selection makes decisions based on the AIC, while the drop-in-deviance test uses the p-value. A potential discrepancy between the two values may have resulted in the different determinations of the significance of sex. We have chosen to use the results of the drop-in-deviance test, and therefore, will be excluding sex from the final model.

```{r}
final_model <- sex_excluded

tidy(final_model) %>%
  kable(digits=3)
```


## Discussion 



[1] http://www.sthda.com/english/articles/32-r-graphics-essentials/125-ggplot-cheat-sheet-for-great-customization/#use-themes-in-ggplot2-package
[2] https://www.datanovia.com/en/blog/the-a-z-of-rcolorbrewer-palette/
[3] https://www2.census.gov/geo/pdfs/maps-data/maps/reference/us_regdiv.pdf
[4] https://stackoverflow.com/questions/12018499/how-to-put-labels-over-geom-bar-for-each-bar-in-r-with-ggplot2 

*keep in mind: citizenship and registration exclusion for the model*