---
title: "Final Written Report: What makes someone more likely to vote?"
author: "Approximately Normal: Jenny Huang, Bella Larsen, Jessie Bierschenk, Aidan Gildea"
date: "17 November 2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE)
```

```{r load-packages, message=FALSE}
library(tidyverse)
library(broom)
library(patchwork)
library(RColorBrewer)
library(ggthemes)
library(viridis)
library(skimr)
```

```{r data}
elections <- read_csv("data/data_full.csv")
```

```{r data cleaning}
elections_clean <- elections %>% 
  mutate(metro = if_else(METRO == 2, "Metro", "Not Metro/Unknown")) %>% 
  mutate(sex = case_when(SEX == 1 ~ "Male",
                         SEX == 2 ~ "Female")) %>% 
  mutate(marst = case_when(MARST == 1 ~ "Married",
                           MARST == 2 ~ "Married",
                           MARST == 4 ~ "Divorced/Separated",
                           MARST == 3 ~ "Divorced/Separated",
                           TRUE ~ "Not Married/Other")) %>% 
  mutate(veteran = if_else(VETSTAT == 2, "Yes", "No/Uknnown")) %>% 
  mutate(citizen = case_when(CITIZEN == 5 | CITIZEN == 9 ~ "No/Unknown", 
                             CITIZEN == 1 | CITIZEN == 2 | CITIZEN == 3 ~ 
                               "Native Born",
                             CITIZEN == 4 ~ "Naturalized")) %>% 
  #There are no observations with 5 or 9 for citizen
  mutate(hispanic_status = if_else(HISPAN == 0 | HISPAN == 901 | HISPAN == 902, 
                             "Not Hispanic/Unknown", "Hispanic/Latinx")) %>% 
  mutate(employed = if_else(LABFORCE == 2, "Yes", "No/Unknown")) %>% 
  mutate(highest_education = case_when(EDUC99 == 0 | EDUC99 == 1 ~ 
                                         "None/Unknown",
                               EDUC99 == 4 | EDUC99 == 5 | EDUC99 == 6 |
                                 EDUC99 == 7 | EDUC99 == 8 | EDUC99 == 9
                               ~ "Some High School",
                               EDUC99 == 10 ~ "High School Degree/GED",
                               EDUC99 == 11 ~ "Some College",
                               EDUC99 == 12 | EDUC99 == 13 | EDUC99 == 14
                               ~ "Associate Degree",
                               EDUC99 == 15 ~ "Bachelors Degree",
                               EDUC99 == 16 ~ "Masters Degree",
                               EDUC99 == 17 ~ "Professional Degree",
                               EDUC99 == 18 ~ "Doctorate Degree")) %>% 
  mutate(current_student = case_when(SCHLCOLL == 5 | SCHLCOLL == 0 ~ 
                                       "Not currently enrolled",
                                     SCHLCOLL == 1  ~ "High School Full Time",
                                     SCHLCOLL == 2 ~ "High School Part Time",
                                     SCHLCOLL == 3 ~ "College Full Time",
                                     SCHLCOLL == 4 ~ "College Part Time")) %>% 
#of people 16-24
  mutate(race = case_when(RACE == 820 | RACE == 830 | RACE == 830 | RACE == 819 
                          | RACE == 804 | RACE == 805 | RACE == 806 | 
                            RACE == 807 | RACE == 808 | RACE == 810 | 
                            RACE == 811 | RACE == 812 | RACE == 813 | 
                            RACE == 814 | RACE == 815 | RACE == 816 | 
                            RACE == 817 | RACE == 818 | RACE == 803 | 
                            RACE == 801 | RACE == 802 | RACE == 830 ~ 
                            "2 or more races",
                          RACE == 100 ~ "White",
                          RACE == 200 ~ "Black",
                          RACE == 651 | RACE == 809 | RACE == 652 | RACE == 650
                          ~ "Asian or Pacific Islander",
                          RACE ==  300 ~ "Native American",
                          RACE == 999 | RACE == 700 ~ "Other/Unknown")) %>% 
  #Need to go over these race categorizations as a group!
  mutate(why_not_vote = case_when(VOWHYNOT == 10 ~ "Inconvenience",
                                  VOWHYNOT == 4 ~ "Interest",
                                  VOWHYNOT == 7 ~ "Political",
                                  VOWHYNOT == 9 | VOWHYNOT ==  6 | 
                                    VOWHYNOT == 5 | VOWHYNOT == 2 ~ 
                                    "Logistical",
                                  VOWHYNOT == 1 ~ "Physically Unable",
                                  VOWHYNOT == 8 ~ "Registration Issues",
                                  VOWHYNOT == 3 ~ "Forgot")) %>% 
#Reason why eligible voter did not vote
  mutate(why_not_reg = case_when(VOYNOTREG == 8 | VOYNOTREG == 3 ~ 
                                   "Not Eligible",
                                 VOYNOTREG == 7 | VOYNOTREG == 6 ~ 
                                   "Not Interested/Vote Won't Matter",
                                 VOYNOTREG == 5 ~ "Language Barrier",
                                 VOYNOTREG == 4 ~ "Physically Unable",
                                 VOYNOTREG == 2 | VOYNOTREG == 1 ~ 
                                   "Lacked Info/Missed Deadline")) %>% 
  mutate(voting_method = case_when(VOTEHOW == 1 ~ "In Person",
                                   VOTEHOW == 2 ~ "Mail-In")) %>% 
  mutate(voting_time = case_when(VOTEWHEN == 2 ~ "Early",
                                 VOTEWHEN == 1 ~"Voting Day")) %>% 
  mutate(voted = case_when(VOTED == 1 ~ 0,
                           VOTED == 2 ~ 1)) %>% 
  mutate(registered = case_when(VOREG == 1 ~ 0,
                           VOREG == 2 ~ 1)) %>% 
  mutate(how_registered = case_when(VOREGHOW == 8 ~ "Online",
                                    VOREGHOW == 7 ~ "Polling Place",
                                    VOREGHOW == 6 ~ "Registration Drive",
                                    VOREGHOW == 5 | VOREGHOW == 2 | 
                                      VOREGHOW == 1 ~ 
                                      "Govt Office/Public Agency",
                                    VOREGHOW == 4 ~ "School/College/Hospital",
                                    VOREGHOW == 3 ~ "By Mail")) %>% 
  mutate(Election = case_when(YEAR %in% c(2004, 2008, 2012, 2016) ~ 
                                                    "Presidential",
                                                  YEAR %in% c(2006, 2010, 2014, 
                                                              2018) ~ 
                                                    "Midterm"),
         Election = factor(Election)) %>% 
    # mutate(Is_Presidential_Election = case_when(YEAR %in% c(2004, 2008, 
    #                                                       2012, 2016) ~ 
    #                                                 "Presidential",
    #                                               YEAR %in% c(2006, 2010, 2014, 
    #                                                           2018) ~ 
    #                                    "Non-Presidential"),
         # Is_Presidential_Election = factor(Is_Presidential_Election)) %>% 
  select(metro, sex, marst, veteran, citizen, hispanic_status, employed, 
         highest_education, current_student, race, why_not_vote, why_not_reg,
         voting_method, voting_time, voted, registered, how_registered, YEAR,
         STATEFIP, AGE, Election)

elections_clean <- elections_clean %>% 
  mutate(metro = factor(metro),
         sex = factor (sex),
         marst = factor(marst),
         veteran = factor(veteran),
         citizen = factor(citizen),
         hispanic_status = factor( hispanic_status),
         employed = factor(employed),
         highest_education = factor(highest_education),
         current_student = factor(current_student),
         race = factor(race),
         why_not_vote = factor(why_not_vote),
         why_not_reg = factor(why_not_reg),
         voting_method = factor(voting_method),
         voting_time = factor(voting_time),
         voted = factor(voted),
         registered = factor(registered),
         how_registered = factor(how_registered))

```

```{r relevel-factors}
elections_clean <- elections_clean %>% 
  mutate(marst = fct_relevel(marst, c("Married", "Divorced/Separated", 
                                      "Not Married/Other")),
         citizen = fct_relevel(citizen, c("Native Born", "Naturalized", 
                                      "No/Unknown")),
         highest_education = fct_relevel(highest_education, 
                                         c("Bachelors Degree", 
                                           "High School Degree/GED",
                                           "Some College",
                                           "Some High School", 
                                           "Associate Degree",
                                           "Masters Degree",
                                           "Professional Degree",
                                           "Doctorate Degree",
                                           "None/Unknown")),
         current_student = fct_relevel(current_student, 
                                       c("Not currently enrolled",
                                         "High School Full Time", 
                                         "High School Part Time",
                                         "College Full Time", 
                                         "College Part Time")),
         race = fct_relevel(race, c("White","Black","Asian or Pacific Islander", 
                                    "Native American", "2 or more races", 
                                    "Other/Unknown")),
         Election = fct_relevel(Election, 
                    c("Presidential", "Midterm")))
```

# Introduction and Data

  In our regression analysis, we will be assuming the role of a nonprofit political organization aiming to design the most effective GOTV ("get out the vote") effort possible. Our primary focus is to increase voter turnout, however, as an organization funded solely by donations, we need to make sure our outreach efforts are as financially efficient as possible. Therefore, it is critical that we are sending our mailing literature primarily to those we believe may not vote -- as this will help turnout voters who may not of voted otherwise. To do so, we will conduct a regression analysis that investigates the different factors and characteristics that may be involved or related to the odds of voting in the U.S. We are using data on voting behaviors in the U.S. over the past 14 years [1]. These data are sourced from IPUMS (an organization that provides census and survey data) and the American Statistical Association (ASA) [2, 1]. These data were originally collected from surveys conducted by the United States Census Bureau and the Bureau of Labor Statistics in a “Voting and Registration Supplement” of the Current Population Survey that occurs every two years after the November elections [1].These data include 28 variables on more than 640,000 survey respondents in the U.S. The data collected contains voter characteristics such as age, geographic location, sex, race, marital status, employment, citizenship, ethnicity, education, and voting history and tendencies [1]. It is important to note that while the variable for current student specifies individuals between the ages of 16 and 24 in the original data codebook, there are no individuals younger than 18 in this dataset. Thus, we will refer to this variable as individuals between the ages of 18 and 24 for the remainder of this analysis. These variables are particularly relevant in exploring what factors may be related to U.S. - Americans voting or not.

  Motivation for our research comes from previous efforts to predict voting behaviors. In an MIT Election data study, researchers describe how understanding voter turnout is important when observing the particular tendencies of certain groups of people as well as factors that motivate individual U.S. citizens to vote [3]. The study highlights general assumptions of voter turnout predictions, noting how higher turnout rates tend to be related to individuals with the following traits: married, white, female, higher education, higher income, older age [3]. The article also addresses how reform may be able to increase voter turnout [3]. In another study done by Harvard graduate student Anthony George Fowler, voter turnout and its implications and repercussions are further examined in the U.S. as well as Australia and Mexico [4]. The study explores the 2008 U.S. election and addresses partisan gaps, voter knowledge (how politically-informed a voter is), and race as main variables of interest in exploring voter tendencies in the U.S. [4]. Both of these studies provide motivation for further and continued investigation into voter data and statistics -- especially for our efforts to understand what populations usually do not make it to the voting booth.

  In anticipation of our GOTV effort, we are interested in explaining what variables influence whether a person voted or not based on a list of variables including sex, age, marital status, veteran status, citizenship status (native born or naturalized citizen), whether or not someone is Hispanic or Latinx, employment status and more. Our proposed research question is: how do voter turnout rates depend on these predictors? Which predictors are more impactful than others? Additionally, we will include an element of prediction about whether someone will vote of not. We are also interested in looking at voter turnout over time. We will use the predictor (year) to see if there are changes in voter turnout by demographics over time, or perhaps compare models from different time periods to determine how voter trends have changed over time. Our organization's initial hypothesis is that the significant predictors of voter turnout will include age, level of education, whether they voted in previous elections, and race. Based on historical patterns, people in older age categories tended to vote more than people in younger age categories and people with higher levels of education tended to vote more frequently than people with lower levels of education [5]. Finally, if a person has voted previously, we predict they will be more likely to vote again compared to someone who has not voted previously. Taking these hypotheses into consideration, we will explore which factors are most significant in relation to voting attendance. Our findings will hopefully allow us to identify populations that are statistically less likely to vote, informing who we target with our GOTV literature in the future.
  
*EDA*
We will begin our EDA by visualizing the relationship between the response variable describing whether or not someone voted and several of the other variables of particular interest. Every vote matters, so we want to make sure no one gets left behind!  

First, we will simply look at the distribution of those who voted throughout the last 8 years of elections.


```{r EDA, fig.height=3, fig.width=5, fig.align='center'}
response_plot <- ggplot(data = elections_clean, aes(x = voted, 
                                                    fill = "gainsboro")) +
  geom_bar() +
  theme_bw() +
  # see theme code inspiration at reference 1 
  theme(plot.title= element_text(face="bold", color = "Navy Blue"),
        plot.subtitle = element_text(face = 4, color = "grey54"),
        panel.grid.major = element_line(color = "Navy Blue", size=.1),
        legend.position = "none") +
  # see scale fill code inspiration at reference 2
  scale_fill_manual(values = c("gainsboro")) +
  labs(title = "Visualizing the Distribution of Voting Status", y = "Count",
       x = "Voted", subtitle = "More people reportedly voted than did not vote",
       caption = "0 = Did not Vote, 1 = Voted")
response_plot
```

*see theme code inspiration at reference [6]*
*see scale fill code inspiration at reference [7]*

From the barplot above, it is clear that more individuals in the data set voted (voted = 1) than did not (voted = 0).

Many political nonprofits engage with college campuses, so we want to analyze whether or not being a student influences the frequency of voting. We will explore this in a preliminary analysis by visualizing the distribution of whether school-aged individuals (18-24) voted or not -- categorized by their current student level. This is seen in the bar plot below.

```{r EDA1, fig.height=3, fig.width=5, fig.align='center'}
EDA1 <- elections_clean %>% 
  ggplot(aes(x = voted, fill = current_student)) +
  geom_bar() +
  theme_bw() +
  theme(plot.title= element_text(face="bold", color = "Navy Blue"),
        plot.subtitle = element_text(face = 4, color = "grey54"),
        panel.grid.major = element_line(color = "Navy Blue", size=.1))+
  #see scale fill brewer code inspiration from reference 1
  scale_fill_brewer(palette = "Blues") +
  labs(title = "Voting Distribution of 18-24 Year Olds", 
       y = "Count", x = "Voted", 
       subtitle = "Examining relationship between student status and voting",
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Current Student Status")
EDA1
```

*see scale fill brewer code inspiration from reference [6]*

From the bar plot, it is evident that a majority of these individuals were not currently enrolled. This may be a result of a general national trend, but we want to investigate if it is the result of a larger proportion of older individuals (aged 23-24) within in the range of ages between 18 and 24. We will investigate this by analyzing those who are not currently enrolled in school within this age range.

```{r age-distribution-college-aged}
elections_clean %>%
  filter(current_student == "Not currently enrolled") %>%
  filter(AGE >=16 & AGE <=24) %>%
  group_by(AGE) %>%
  count()  %>% 
  ungroup() %>%
  mutate(prop = n/sum(n)) %>%
  kable(digits = 3, 
  caption = "Proportion of Respondents Not Currently Enrolled In School By Age")
```

From the table above, it is apparent that more than 40% of those not currently enrolled in school are 23-24 years old. This could be a potential reason for why this age range includes so many who are not currently enrolled as a student. 

To more meaningfully analyze the relationship between being a student and if they vote or not, we adjusted our visualization to only include those currently enrolled in some level of education. This is seen in the visualization below. 

```{r EDA2, fig.height=3, fig.width=5, fig.align='center'}
EDA2 <- elections_clean %>% 
  filter(current_student != "Not currently enrolled") %>% 
  ggplot(aes(x = voted, fill = current_student)) +
  geom_bar() +
  theme_bw() +
    theme(plot.title= element_text(face="bold", color = "Navy Blue"),
        plot.subtitle = element_text(face = 4, color = "grey54"),
        panel.grid.major = element_line(color = "Navy Blue", size=.1))+
  scale_fill_brewer(palette="Blues") +
  labs(title = "Voting Distribution of 18-24 Year Olds \nEnrolled in School", 
       y = "Count", x = "Voted", 
       subtitle = "Examining relationship between student status and voting",
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Current Student Status")
EDA2
```

This visualization shows that respondents between the age 18 and 24 enrolled in some education at the time were mainly full time college students. More full time and part time college students that were eligible to vote did vote compared to those that did not vote. The opposite is true for high school students: more full time and part time high school students that were eligible to vote did not vote compared to those that did vote. 

Next we will consider the voting distributian based on citizen status.

```{r EDA3, fig.height=3, fig.width=5, fig.align='center'}
citizen_plot <- elections_clean %>% 
  group_by(citizen) %>% 
  count(voted) %>% 
  mutate(total = sum(n)) %>% 
  mutate(prop = n/total) %>% 
  mutate(prop = round(prop, 3))
citizen_plot %>% 
  ggplot(aes(x = voted, y = prop, fill = citizen)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = prop), vjust = 0.5) + 
  #see geom_text() code inspiration in reference [4]*
  facet_grid(cols = vars(citizen))+
  scale_fill_brewer(palette = "Blues") +
  labs(title = "Voting Distribution Based on Citizenship Status", 
       y = "Proportion", x = "Voted", 
     subtitle = "Examining relationship between citizenship status and voting",
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Citizenship Status") +
  theme_bw()
```

*see geom_text() code inspiration in reference [8]*

This visualization shows that for both randomly sampled native born and naturalized individuals, more citizens voted than did not; however, the proportion is much greater for native born citizens than for naturalized. For a similar plot comparing respondents by veteran status, please consult Appendix A.

Next we will consider the voting distributian based on age. It has previously been shown that age has an effect on voting.

```{r EDA4, fig.height=3, fig.width=5, fig.align='center'}
elections_clean %>% 
  ggplot(aes(x = AGE, y = voted)) +
  geom_boxplot(fill = "gray") +
  coord_flip() +
  labs(title = "Relationship Between Age and Voting", 
       y = "Voting Status", x = "Age", 
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Citizenship Status")+
  theme_bw()

```

This box plot shows that respondents that did vote were generally older than respondents that did not vote.

We are also interested in looking at how voter turnout has changed over the
years.

```{r year-voting-frequency}
elections_year <- elections_clean %>% 
  group_by(YEAR) %>% 
  count(voted) %>% 
  mutate(prop_voted = n/sum(n))
```

We notice that the proportion of people who voted fluctuates depending on whether the year falls on a presidential election. In the trend of the proportion of voting over time, we see a clear divide between voting depending on presidential election year. However, ranges including the interquartile range of the boxplots overlap. In the future, we may decide to add the variable "Election Year" as an interaction term in the model.

```{r EDA6, fig.height=3, fig.width=4.5, fig.align='center'}
elections_year %>% 
  filter(voted == 1) %>% 
  ggplot(aes(x = YEAR, y = prop_voted)) +
  geom_point() +
  labs(title = "Visualizing Proportion of Voters Over Time", 
       y = "Proportion of People Who Voted", x = "Year")
```

We decided to look at the scatterplot of voter turnout over time broken down by the status of the election (Presidential election, midterm after incumbent president, or midterm after new president) to see how it may differ depending on the election.

```{r scatterplot-over-time, fig.height=3, fig.width=6, fig.align='center'}
elections_year %>% 
  mutate(Election_new = case_when(YEAR %in% c(2004, 2008, 
                                                          2012, 2016) ~ 
                                                    "Presidential",
                                                  YEAR %in% c(2006, 2014) ~ 
                                       "Midterm Following Incumbent President",
                                          YEAR %in% c(2010, 2018) ~ 
                                          "Midterm Following New President"),
        Election_new = factor(Election_new)) %>% 
  filter(voted == 1) %>% 
  ggplot(aes(x = YEAR, y = prop_voted, color = Election_new)) +
  geom_point() +
  labs(title = "Higher Proportion of Voters During Presidential Election Years", 
       y = "Proportion of People Who Voted", x = "Year", 
       color = "Presidential Election Year", caption = "1: Yes; 0: No")
```

From the above scatterplot, we confirmed that there is higher voter turnout during presidential elections compared to midterm elections. In addition, there is equal or higher voter turnout for midterm elections following the election of a new president compared to midterm elections following the election of an incumbent president, and an especially high voter turnout in the midterm election after Trump's election in 2016. We also noticed the two midterm types are similar, so we will combine the two midterms into one variable should we use it as an interaction term.

Finally, it is important to acknowledge the missingness in our data, as it may influence the outcome of our regression analysis. The initial data sourced from the "This Is Statistics: Fall Data Challenge" used non-uniform values for the different variables, therefore we cleaned the data to be more intelligible for our analysis. While cleaning, we did impute "NA" values by either combining them with other categories and/or removing them to improve our analysis. We believe this will not negatively affect our analysis, yet we will move forward taking it into consideration. 

After analyzing these preliminary visualizations and observations, we will now begin to build our model. 

# Methodology

This data set was originally coded with different numerical values which would 
have made analysis difficult. Therefore, we re-coded the data to make it more 
intelligible by using the codebook provided with the data download on 
Google Drive [1]. This was done in the data cleaning process by 
re-coding the numerical values into string identifiers or binary numerical 
identifiers. The new dataset, `elections_clean`, is too large to load into the 
data folder and push to github, so we have included the raw dataset in the data
folder, and the cleaned data-set can be attained by running the code in the Rmd.

The primary response variable of our regression analysis will be whether or not
someone voted, the variable called `voted`. The variable `voted` is 
a categorical variable that identifies whether or not a respondent
voted in the most recent November election. Hence, we used a logistic 
regression model for the binary response.

## Model Selection

In order to make our model, we have decided to take a random sample of 10,000 to be sure that the model selection is accurate and not obscured by too many observations. 

```{r random-sample, message = FALSE}
set.seed(6687) 
elections_red <- elections_clean %>%
  sample_n(10000)
```

As we were interested in looking at variables that may help explain voter turnout, we started by considering all relevant predictor variables. We considered starting with a full model including sex, age, whether it was a Midterm or presidential election year, the year of the election, marital status, veteran status, citizenship status (native born or naturalized citizen), whether or not someone is Hispanic or Latinx, employment status, whether someone lives in a metropolitan area, highest education level attained, whether someone is a current student, and race.

Using the random sample of 10,000 observations, we began the model selection process using backwards selection using AIC criteria. See Appendix B for the full backward selection output and the full model output.

```{r backward-selection, include=FALSE}
int_only_model <- glm(voted ~ 1,
                     data = elections_red,
                      family = "binomial")

full_model <- glm(voted ~ metro + sex + marst + veteran+ citizen + 
                   hispanic_status + employed + highest_education + 
                   current_student + race + AGE + Election
                 + YEAR,
                     data = elections_red,
                      family = "binomial")

best_model <- step(full_model, scope=formula(int_only_model), 
                   direction = "backward")

```

```{r tidy model, include=FALSE}
tidy(best_model) %>% 
  kable(digits = 3, caption = "Model Resulting From Backward Selection")
```

The final model included predictor variables for sex, whether someone between ages 18 and 24 is currently enrolled in school, citizenship status, employment status, race,  marital status, whether it was a presidential election year or a midterm election year, respondent age, and the highest education level of the respondent. 

The backward selection based on AIC removed the variables for the year, whether someone is from a metro area, veteran status, and hispanic status (see Appendix B).


## Interaction Terms

We will add in several interaction terms of interest and use a drop-in-deviance test to see if they are meaningful predictors of the odds of someone voting.

The reduced model is the same as the model titled "Model Resulting From Backward Selection," (see Appendix B) and the full model is the reduced model plus interactions terms for sex and employment, election type and highest education level, sex and election type, and race and election type.

The following hypotheses will be used:

$H_0$: the coefficients for the interaction between election type and highest education level, sex and election type, and race and election type are all zero.

$H_0:$

$\beta_{sex*employed} = \beta_{Election*highest_education} = \beta_{sex*Election} = \beta_{race*Election} = 0$

$H_a$: at least one of these coefficients for the interaction terms $\neq$ zero.

$\alpha = 0.05$

```{r interaction, include=FALSE}
reduced_model <- best_model

full_model <- glm(voted ~ sex + current_student + citizen + employed + 
                    race + marst + Election + AGE + 
                    highest_education +
                    Election*highest_education + 
                    sex*Election + 
                    race*Election,
                     data = elections_red,
                      family = "binomial")

```
```{r drop-in-deviance1}
anova(reduced_model, full_model, test = "Chisq") %>%
  tidy() %>% 
  kable(digits = 3, 
        caption = "Drop-In-Deviance Test Results For Interaction Terms")
```

```{r model-output-interaction, include=FALSE}
tidy(full_model) %>% 
  kable(digits = 3)
```


The p-value (approximately 0) is very small (less than the alpha level 0.05), 
so we can reject the null hypothesis. Thus, we conclude that the data provide 
sufficient evidence that at least one of the coefficients associated with the additional 
interaction terms is not equal to 0. Therefore, we should add them to the model. 
See Appendix C for the full model output resulting from the additional interaction terms.


```{r resulting-model}
reduced_model <- best_model

full_model <- glm(voted ~ sex + current_student + citizen + employed + 
                    race + marst + Election + AGE + 
                    highest_education +
                    Election*highest_education + 
                    sex*Election + 
                    race*Election,
                     data = elections_red,
                      family = "binomial")
```

We will use a drop-in-deviance test to determine whether or not sex is a 
meaningful predictor of the odds of someone voting.

The following hypotheses will be used:

$H_0$: the coefficients for the main effect for sex and the interaction between sex and election type are all zero. All of the coefficients associated with sex are equal to zero.

$H_0:$ $\beta_{sex} =\beta_{sex*employed} = \beta_{sex*Presidential-Election-Status} = 0$

$H_a$: at least one of these coefficients for the coefficients associated with sex $\neq$ zero

$\alpha = 0.05$

```{r model-with-sex}
sex_included <- glm(voted ~ sex + current_student + citizen + employed + 
                    race + marst + Election + AGE + 
                    highest_education +
                    Election*highest_education + 
                    sex*Election + 
                    race*Election,
                     data = elections_red,
                      family = "binomial")

sex_excluded <- glm(voted ~ current_student + citizen + employed + 
                    race + marst + Election + AGE + 
                    highest_education +
                    Election*highest_education + 
                    race*Election,
                     data = elections_red,
                      family = "binomial")
```


```{r drop-in-deviance2}
anova(sex_excluded, sex_included, test = "Chisq") %>%
  tidy() %>% 
  kable(digits = 3, caption = "Drop-In-Deviance Test Results For Sex")
```

From the drop-in-deviance test used to determine if we should include variable sex, the p-value (0.138) is greater than an alpha-level of 0.05, so we will exclude the main effect for sex and the interaction terms including sex from the model. This contradicts the AIC results from the backward selection that determined that we should keep sex in the model, which is most likely due their different criteria for statistical significance. Backward selection makes decisions based on the AIC, while the drop-in-deviance test uses the p-value. A potential discrepancy between the two values may have resulted in the different determinations of the significance of sex. We have chosen to use the results of the drop-in-deviance test, and therefore, will be excluding sex from the final model.

# Results

```{r final-voting-model}
voting_model <- sex_excluded

tidy(voting_model) %>%
  kable(digits=3, caption = "Final Model Output")
```

Referencing the previous EDA plot titled "Higher Proportion of Voters During Presidential Election Years," we noticed a large difference in voting frequency in Midterm versus Presidential elections (with Presidential elections witnessing a higher voter turnout rate). With this observation, we wanted to determine if the impact of other predictor variables differed based on election type (Midterm or Presidential). Because we want to target unlikely voters, it is important to know how the effect of certain characteristics (predictor variables) differs in a given election year. This knowledge will allow us to appropriately target individuals less likely to vote in the election of interest. 

**Voting During Presidential Election Years**

We found that variables associated with race are significant predictors of the odds of voting during a Presidential election year. The following interpretations describe how the respective characteristics in our predictor variables affect the odds of voting during presidential election years compared to a baseline of individuals who are White, after accounting for all other variables.

Specifically, the odds of voting for Black individuals are expected to multiply by a factor of `r round(exp(0.897), 3)` (exp(0.897), p < 0.05) compared to White individuals. In contrast, based on our model, the odds of voting for Asian or Pacific Islander individuals are expected to multiply by a factor of `r round(exp(-0.743), 3)` (exp(-0.743), p < 0.05) compared to White individuals. 

The p-values for the coefficients related to Native American individuals of two or more races (p = 0.276, p = 0.633, respectively) are greater than the alpha level of 0.05, indicating that there is not sufficient evidence that the odds of voting differ significantly between these populations and White individuals, after accounting for all other variables.

In addition to race, we found that variables associated with highest education level are also significant predictors of the odds of voting during a Presidential election year. The following interpretations describe how the respective characteristics in our predictor variables affect the odds of voting during presidential election years compared to a baseline of individuals with a Bachelor's degree as their highest level of education, after accounting for all other variables:

In general, we can see that as the highest education level goes from a Bachelor's degree to a high school degree, the odds of voting decrease by a multiplicative factor. And as the highest education level goes from a Bachelor's degree to a Master's degree, the odds of voting increase by a multiplicative factor. More specifically, the odds of voting for individuals with a high school degree or GED as their highest level of education are expected to multiply by a factor of `r round(exp(-1.647), 3)` (exp(-1.647), p < 0.05) compared to the baseline. Similarly, the odds of voting for individuals with some college as their highest level of education are expected to multiply by a factor of `r round(exp(-0.834), 3)` (exp(-0.834), p < 0.05) compared to the baseline. Similarly, the odds of voting for individuals with some high school as their highest level of education are expected to multiply by a factor of `r round(exp(-2.552), 3)` (exp(-2.552), p < 0.05) compared to the baseline. In congruence with the previous results, the odds of voting for individuals with an Associate's degree as their highest level of education are expected to multiply by a factor of `r round(exp(-0.621), 3)` (exp(-0.621), p < 0.05) compared to the baseline. Similarly but to a greater degree, the odds of voting for individuals who responded with none/unknown for their highest level of education are expected to multiply by a factor of `r round(exp(-3.452), 3)` (exp(-3.452), p < 0.05) compared to the baseline.

The difference in odds changes direction with the Master's degree; the odds of voting for individuals with a Master's degree as their highest level of education are expected to multiply by a factor of `r round(exp(0.619), 3)` (exp(0.619), p < 0.05) compared to the baseline.

The p-values for the coefficients related to highest education level as professional degree and doctorate degree (p = 0.05, p = 0.913 respectively) are greater than or equal to the alpha level of 0.05, indicating that there is not sufficient evidence that the odds of voting differ significantly between these populations and individuals with a Bachelor's degree as their highest level of education, after accounting for all other variables. 


**Voting During Midterm Election Years**

In contrast to the previous results, during a midterm election, the descriptions below show how the patterns are expected to change compared to presidential election years:

Similarly to the results of presidential election years, we found that variables associated with race are significant predictors of the odds of voting during a Midterm election year. They differ in their relationship and magnitude, however. The following interpretations describe how the respective characteristics in our predictor variables affect the odds of voting during Midterm election years compared to a baseline of individuals who are White, holding all else constant:


In contrast to presidential years, the odds of voting for Black individuals are expected to multiply by a factor of `r round(exp(-0.494-1.152), 3)` (exp(-0.494-1.152), p < 0.05) compared to White individuals. The odds of voting for Asian or Pacific Islander individuals are expected to multiply by a factor of `r round(exp(0.630-1.152), 3)` (exp(0.630-1.152), p < 0.05) compared to White individuals. And, the odds of voting for individuals that are two or more races are expected to multiply by a factor of `r round(exp(0.836-1.152), 3)` (exp(0.836-1.152), p < 0.05) compared to White individuals.

The p-value for the coefficient related to Native American (p = 0.221) is greater than the alpha level of 0.05, indicating that there is not sufficient evidence that the odds of voting differ significantly between this population and White individuals, holding all else constant.

In addition to race, we found that variables associated with highest education level are also significant predictors of the odds of voting during a Midterm election year. The following interpretations describe how the respective characteristics in our predictor variables affect the odds of voting during Midterm election years compared to a baseline of individuals with a Bachelor's degree as their highest level of education, holding all else constant:

The odds of voting for individuals with a high school degree or GED as their highest level of education are expected to multiply by a factor of `r round(exp(0.475-1.152), 3)` (exp(0.475-1.152), p < 0.05) compared to the baseline. Similarly, the odds of voting for individuals with some high school as their highest level of education are expected to multiply by a factor of `r round(exp(0.590-1.152), 3)` (exp(0.590-1.152), p < 0.05) compared to the baseline.

Many more coefficients associated with highest education during midterm election years were not significantly different from the baseline compared to during presidential years. The p-values for the coefficients related to highest education level as some college, Associate's degree, Master's degree, professional degree, none/unknown, and doctorate degree (p = 0.056, p = 0.479, p = 0.084, p = 0.151, p = 0.544, p = 0.347 respectively) are greater than the alpha level of 0.05, indicating that there is not sufficient evidence that the odds of voting differ significantly between these populations and individuals with a Bachelor's degree as their highest level of education, holding all else constant.

**Voting Across Election Years**

In contrast, according to our model, several predictor variables affect the odds of voting the same, regardless of the election type. These include current student status (if applicable), citizenship status, employment status, marital status, and age.

In general, we see that being enrolled in school as a 18 to 24 year old tends to increase the odds of voting. The highest increase occurs for individuals who are enrolled in high school full-time; the odds of voting for these individuals are expected to multiply by a factor of `r round(exp(1.155), 3)` (exp(1.155), p < 0.05) compared to individuals within the same age range that are not currently enrolled in school, holding all else constant. While it still increases the odds of voting, being enrolled in college full time and college part time differ in magnitude of the change. The odds of voting (if 18-24 years old) for individuals who are enrolled in college full-time are expected to multiply by a factor of `r round(exp(0.455), 3)` (exp(0.455), p < 0.05) compared to individuals within the same age range that are not currently enrolled in school, holding all else constant. Similarly, the odds of voting (if 18-24 years old) for individuals who are enrolled in college part-time are expected to multiply by a factor of `r round(exp(0.569), 3)` (exp(0.569), p < 0.05) compared to individuals within the same age range that are not currently enrolled in school, holding all else constant.

Additionally, the p-value for the coefficient related to individuals (if 18-24 years old) who are enrolled in high school part-time (p = 0.756) is greater than the alpha level of 0.05, indicating that there is not sufficient evidence that the odds of voting differ significantly between this population and those within the same age range that are not currently enrolled in school, holding all else constant

The coefficient associated with citizenship status is also a significant predictor of the odds of someone voting. The odds of voting for individuals who a naturalized citizen are expected to multiply by a factor of `r round(exp(-0.681), 3)` (exp(-0.681), p < 0.05) compared to individuals who are native-born citizens, holding all else constant.

The coefficient associated with employment status is also a significant predictor of the odds of someone voting. The odds of voting for individuals who are currently employed are expected to multiply by a factor of `r round(exp(0.395), 3)` (exp(0.395), p < 0.05) compared to individuals who are not currently employed, holding all else constant.

The coefficient associated with marital status is also a significant predictor of the odds of someone voting. The odds of voting for individuals who are divorced or separated are expected to multiply by a factor of `r round(exp(-0.710), 3)` (exp(-0.710),p < 0.05) compared to individuals who are married, holding all else constant. Similarly, the odds of voting for individuals who are not married/unknown are expected to multiply by a factor of `r round(exp(-0.477), 3)` (exp(-0.477), p < 0.05) compared to individuals who are married, holding all else constant.

As we would expect, a key demographic that influences voter turnout is age. For each additional year in age, the odds voting are expected to multiply by a factor of `r round(exp(0.040), 3)` (exp(0.040), p < 0.05), holding all other predictor variables constant.

## Checking Model Conditions for Final Model

**Linearity**

According to the empirical logit plot (see Appendix D), there is an approximately linear relationship between the log-odds of voting and the predictor variable age. Hence linearity is satisfied for the predictor variable for age. The additional variables in our final model are all categorical, so we do not need to assess the empirical logit for these to determine whether the linearity assumption is satisfied.  

**Randomness**

It is possible that randomness is not satisfied because our data is from the census survey, which may not be random. For example, the survey might select for people who have time to fill it out. However, there is no reason to believe that this will not generalize to the U.S. population as a whole in terms of the survey responses in a significant way, particularly due to the large sample size. Thus, we conclude that the randomness condition is satisfied.

**Independence**

Independence may be violated because geographic location may influence voting due to factors such as relationships between individual states and voting patterns. Hence, we will look at misclassification rate by region to determine whether independence could be violated due to the spatial relationships within our data. To do so, we consulted a confusion matrix with a decision threshold of 0.5 by region. This allows us to look at misclassification rates by region (see the table below) and determine whether our model is systematically erroneous in predicting voting patterns for certain regions.

```{r create-confusion-matrix, include=FALSE}
library(maps)
data(state.fips)
joined_fips <- left_join(elections_red, state.fips, by = c("STATEFIP" = "fips"))

model_aug <- augment(voting_model, type.predict = "response") #probability

model_aug <- model_aug %>% 
  mutate(predicted_voted = if_else(.fitted > 0.5, "Will Vote", "Will Not Vote"))

tojoin <- joined_fips %>% 
  select(AGE, region)

aug_fips <- left_join(model_aug, tojoin, by ="AGE")
```

```{r misclassification-rates-by-region}
aug_fips <- aug_fips %>% 
  mutate(region = case_when(region == 1 ~ "Northeast",
                            region == 2 ~ "Midwest",
                            region == 3 ~ "South",
                            region == 4 ~ "West"))
# used Census data for the region fips number corresponding to region name [3]

missclassification <- aug_fips %>% 
  group_by(region) %>% 
  count(voted, predicted_voted) %>%  
  #all combs of responses specified as arguments
  mutate(prop = n / sum(n)) %>% 
  filter(voted == 1 & predicted_voted == "Will Not Vote" | 
        voted == 0 & predicted_voted == "Will Vote")
missclassification %>% 
  kable(digits = 3, caption = "Missclassification Rates by Region")
```

*Consulted Census data for the region FIPS number corresponding to region name [9]*

Based on the misclassification rates by region, we have no reason to believe that the independence condition is not satisfied. The misclassification rates across regions are relatively similar and do not differ systematically between regions, which suggests that there is not an issue of spatial correlation. Because we were only concerned about independence in the spatial relationship between observations, we conclude that the independence condition is satisfied for our model.

## Checking for influential points

```{r obs-num, include=FALSE}
final_best_aug <- augment(voting_model) %>%
   mutate(obs_num = row_number()) #add row number to help with graphing
```

**Cook's distance**

We will also look for influential points in our final model using a plot of Cook's
Distance.

```{r Cooks-final, fig.height=3, fig.width=6, include=FALSE}
## scatterplot of Cook's D vs. observation number
ggplot(data = final_best_aug, aes(x = obs_num, y = .cooksd)) +
  geom_point(alpha = 0.7) +
  geom_hline(yintercept = c(0.5,1), color = "red", lty = 2) +
  labs(x = "Observation Number", y = "Cook's D") +
  geom_text(aes(label = ifelse(.hat > 0.5,
                           as.character(obs_num), "")), nudge_x = 1)
```

According to the Cook's Distance plot for the final model (see Appendix D), there are no influential points (all of our points fall well below the threshold of 0.50 for Cook's Distance), so all points can be left in the final model.

**Multicollinearity**

All of the VIF values are under the threshold of 10 (see the VIF table in Appendix D), indicating that there is no evidence of multicollinearity in our data.

## Creating a Classifier

After creating our final model, we created a classifier for predicting whether an individual would be likely to vote with a goal of deciding whether or not an organization should send a voting mailer encouraging the person to vote. Through creating an ROC curve, we were able to choose a threshold that maximized sensitivity while also minimizing the false positive rate (1-specificity), keeping in mind that we aim to prioritize having a lower false positive rate than a higher sensitivity value, since it does not hurt to mail a few extra informational mailers to people who may already be planning to vote.

We'll fit an ROC curve to help us determine a decision-making threshold. 

```{r augment-for-roc}
voting_aug <- augment(voting_model, type.predict = "response") %>%
  mutate(voted = fct_relevel(voted, c("1", "0")))
```

```{r calculate-threshold-levels}
library(broom)
library(yardstick)

# calculate sensitivity and specificity at each threshold
roc_curve_data <- voting_aug %>%
  roc_curve(voted, .fitted) %>%
  mutate(pred_prob = exp(.threshold)/(1 + exp(.threshold)))
```


```{r roc-curve-plot, fig.height=3, fig.width=3, fig.align="center"}
autoplot(roc_curve_data) +
  labs(title = "ROC Curve For Final Model")
```

In the table below, we look at values within a range of thresholds in order to choose the 
threshold that yields high sensitivity and low values of the false positive 
rate (1 - specificity).

```{r roc-curve-threshold}
roc_curve_data <- roc_curve_data %>%
  mutate(false_pos_rate = (1 - specificity))
roc_curve_data %>%
  filter(.threshold > .715, .threshold < .716) %>% 
  kable(digits = 3, caption = "ROC Curve Threshold Table")
```

In reference to our ROC curve and modeling objectives, we will choose a threshold of 0.716 because we want to prioritize having a lower false positive rate (and avoid making a type I error) than having higher true positive rate, or sensitivity, as it does not hurt to mail a few extra mailers to people who  may already be planning to vote. Because our decision will be to not send a mailer if the predicted probability is greater than the threshold, we want to be sure that we are not inaccurately predicting someone to vote when they truly will not, which means that we want to minimize our false positive rate.

At this threshold, we have a sensitivity of about 0.602, which means that our model prediction will correctly identify about 60% of people who will vote. In other words, using this threshold, of the people who will actually vote, we will capture about 60.2% of them. Our false positive rate is 0.213, which means that with our current threshold, we are predicting "yes" for about 21.3% of people who will actually not vote.  

Any data point with a probability over 0.716 will be predicted to be in the "voted" category and will therefore not be sent a mailer.


# Discussion 

In completing this project, we were able to identify several strong predictors of voting behavior in the United States. Overall, significant predictors of the odds of someone voting were the variables associated with education, type of election (presidential or midterm), age, citizenship status (naturalized or native-born), employment status, and marital status. The predictor variables associated with education were especially intriguing, because their statistical significance highlights the huge impact of enrollment in formal education in the U.S., as well as the immense disparities baked into the U.S. formal education system. As discussed in the results section, we can see that being enrolled in school (high school full-time or college full- or part-time) an 18 to 24 year-old tends to increase the odds of voting compared to those not enrolled and those enrolled in high school part time, regardless of the election year (presidential or midterm election). This is evidenced by the positive coefficients and low p-values that can be seen in the final model output in the results section and discussed in more depth in the results section. The one exception is that for individuals enrolled in high school part-time, there is not a significant difference in the odds of voting compared to individuals who are not enrolled in school, as evidenced by a p-value of 0.756. This suggests that special attention should be paid to these individuals and voting encouragement should be especially targeted towards 18 to 24 year-olds who are either not enrolled in school, or enrolled in high school part-time.

We see that the disparities in voter turnout persist past the age group of younger students (18 to 24 years old), as many of the coefficients associated with the highest level of education attained over the respondent's lifetime are significantly different than the baseline level of a bachelor's degree. However, it is important to note that the difference from the baseline level is much more significant during presidential election years than midterm election years, based on a greater number of predictor variables being significant in the main effect terms associated with highest education level compared to the interaction terms associated with election year and highest education level. During a presidential year, the odds of voting for individuals who have a high school degree or a GED, some college, some high school, no degree or responded "unknown," or an associate's degree are expected to be smaller by a statistically significant multiplicative factor than individuals with a bachelor's degree. In comparison, during presidential election years, the odds of voting for individuals who have a master's degree are expected to be larger by a statistically significant multiplicative factor than individuals with a bachelor's degree. It is interesting to note that the effect of higher levels of formal education or degrees on increasing the odds of voting during presidential election years tends to become insignificant after a master's degree, as evidenced by the p-values greater than 0.05 for professional and doctorate degrees. In contrast, during midterm election years, the effect of the highest education level achieved become much less significant when compared to the baseline level of a bachelor's degree, suggesting that interventions must consider midterm election years overall, as the odds of voting during these years tend to be lower in general. These results suggest that policymakers should consider interventions to help engage the population who are not enrolled in formal education and those who are enrolled in high school part-time in the voting process. Furthermore, these results confirm that there are persistent educational disparities that significantly affect politics in the U.S.

The predictor variable for employment status is the most applicable indicator for socioeconomic status in our final model. We can see that employment status is a significant predictor of the odds of voting across presidential and midterm election years. More specifically, the odds of voting for those who are employed are expected to be `r round(exp(0.395), 3)` (exp(0.395), p < 0.05) times the odds for those who are not employed, holding all other predictor variables constant. This indicates that in additional to interventions targeting educational factors, policymakers and voting organizations should consider targeting individuals who are not employed, and perhaps by extension, individuals of lower socioeconomic status. A future research project expanding on this work could consider additional indicators of socioeconomic status, perhaps by Census tract if more granular data are not available. We know that aspects of socioeconomic status and education are tightly intertwined, so it is not necessarily surprising that we see similar results for the odds of voting across school-aged individuals who are not enrolled in formal education and individuals who are not employed. 

It is also intriguing to consider the differences in the effect of race on the odds of voting during presidential election years compared to midterm election years. Based on our results, when going from a presidential election year to a midterm election year, the odds of voting differs across races. The increase in the odds of voting for Black individuals compared to White individuals during presidential years goes away during midterm election years, since the odds of voting for Black individuals are expected to multiply by a factor less than one when compared to White individuals during midterm election years (while the odds of voting for Black individuals are more than twice as likely to vote than White individuals during presidential election years). The trends for the odds of voting for Asian or Pacific Islander individuals compared to White individuals tend to remain relatively constant at a multiplicative factor less than one for both presidential and midterm election years. Similarly, the trends in the odds of voting for Native American individuals remain not significantly different than white individuals across election types. Interestingly, though, the trends in the odds of voting for individuals of two or more races is not significantly different than White individuals during presidential years, but becomes significantly different than white individuals by a multiplicative factor less than one during midterm election years. These results suggest that organizations who wish to target unlikely voters and consider race to be an influential factor in this process must also keep in mind that the effects of race differ depending on the election type and different interventions are needed during presidential election years compared to midterm election years.

Additionally, it is known that young voters are a particularly important demographic to target to increase voter turnout [10]. Our data reflect this established fact; based on our model, for each additional year in age, the odds voting are expected to multiply by a factor of `r round(exp(0.040), 3)` (exp(0.040), p < 0.05), holding all other predictor variables constant. This result, coupled with the finding that the odds of voting are greater for individuals enrolled in formal education, suggest that there needs to be intervention at an even earlier age to increase voter turnout. Perhaps by increasing access to early education, increasing financial support of students through high school and college, and increasing messaging about voting to younger individuals, the voter turnout could be increased. We also used our model to address voter turnout from a more policy angle by taking on the role of a “Get Out the Vote” organization. We determined that our model could inform a decision threshold of  0.716 to optimize the decision making process of sending out informational mailers about voting. 

While completing this project provided excellent insight into the voting patterns in the United States, there are several limitations of this project that must be acknowledged. First, the original dataset hard-coded several variables with "unknown" and "missing" combined into one category. This could have obscured the effects of missingness in our data and contributed to decreasing the predictive accuracy of our model and results. For this reason, if given the opportunity to expand this project, we would like to explore missingness in our dataset and its implications with more depth to improve our model. Because several categorical variables already had levels that combined missing and unknown, we decided to code the other variables in the same way, effectively imputing a new category for missing that was used in the model. While this was the best way to deal with missingness within the scope of this project, we would be interested in expanding this in the future and teasing out missing from unknown to create a more accurate model and improve our results.

Additionally, there are several aspects of our modeling process that had limitations that we would like to address. Our primary modeling objective for this project was explanation. We wanted to understand all of the different factors that influence voter turnout, especially given such a rich dataset with so many interesting variables. Thus, we spent a lot of time interpreting our coefficients and ensuring that we did not have issues of multicollinearity in our model using a table of VIF values. However, we also wanted to expand our project to include an element of prediction by determining a decision threshold for whether or not to send an informational voting mailer to different individuals based on the predicted probability of them voting using our model. We acknowledge that this conflicts our original modeling goal of explanation, which could reduce the predictive accuracy of our model for this purpose, given that we kept several variables that were not statistically significant in our model for the purposes of interpretation. However, we believe that this choice is still consistent with the goal of sending mailers to individuals because this decision is relatively low-stakes, and false-negatives and false-positives do not have impactful consequences. Nonetheless, if given the chance to expand this project, we would address this limitation by creating a second model with the goal of prediction in mind. For this model, we would only keep the strongest predictors of the response variable, whether someone will vote, to reduce the prediction intervals and improve the classifier we created. 

Overall, this project allowed us to better understand the impact of different predictor variables on the odds of whether someone votes, and it allowed us to use our model to make an informed decision about whether to send a voting information mailer to unlikely voters. Policymakers should be especially interested in these findings because our political system should be inclusive of everyone, and we can see that people are systematically being left out of the democratic process.


\newpage

# References

[1]“Fall Data Challenge | This Is Statistics.” n.d. Accessed November 16, 2020. https://thisisstatistics.org/falldatachallenge/.

[2] University of Minnesota. “What Is IPUMS?” Text. IPUMS. February 7, 2019. https://ipums.org/what-is-ipums.

[3] MIT Election Data + Science Lab. n.d. “Voter Turnout.” Accessed November 16, 2020. https://plotly.com/~cwimpy/69/.

[4] Fowler, Anthony George. 2013. “Five Studies on the Causes and Consequences of Voter Turnout,” October. https://dash.harvard.edu/handle/1/11156810.

[5] McDonald, Michael. n.d. “Voter Turnout Demographics - United States Elections Project.” Accessed November 16, 2020. http://www.electproject.org/home/voter-turnout/demographics.

[6] “GGPlot Cheat Sheet for Great Customization - Articles - STHDA.” Accessed November 15, 2020. http://www.sthda.com/english/articles/32-r-graphics-essentials/125-ggplot-cheat-sheet-for-great-customization/.

[7] Datanovia. “The A - Z Of Rcolorbrewer Palette You Must Know,” November 18, 2018. https://www.datanovia.com/en/blog/the-a-z-of-rcolorbrewer-palette/.

[8] Stack Overflow. “How to Put Labels over Geom_bar for Each Bar in R with Ggplot2.” Accessed November 15, 2020. https://stackoverflow.com/questions/12018499/how-to-put-labels-over-geom-bar-for-each-bar-in-r-with-ggplot2.

[9] Prepared by the Geography Division of the U.S. Census Bureau. “Census Regions and Divisions of the United States.” United States Census Bureau, n.d. https://www2.census.gov/geo/pdfs/maps-data/maps/reference/us_regdiv.pdf.

[10] Symonds, Alexandria. “Why Don’t Young People Vote? - The New York Times.” The New York Times, October 8, 2020. https://www.nytimes.com/2020/10/08/upshot/youth-voting-2020-election.html.
 
[11] R Documentation. “Emplogitplot1 Function.” Accessed November 17, 2020. https://www.rdocumentation.org/packages/Stat2Data/versions/2.0.0/topics/emplogitplot1.


\newpage

# Appendix A

## EDA for Veteran Status

```{r EDA5, fig.height=3, fig.width=5}
veteran_plot <- elections_clean %>% 
  group_by(veteran) %>% 
  count(voted) %>% 
  mutate(total = sum(n)) %>% 
  mutate(prop = n/total) %>% 
  mutate(prop = round(prop, 3))
veteran_plot %>% 
  ggplot(aes(x = voted, y = prop, fill = veteran)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = prop), vjust = 0.5) +
  #see geom_text() code inspiration in reference [4]*
  facet_grid(cols = vars(veteran))+
  scale_fill_brewer(palette = "Blues") +
  labs(title = "Voting distribution based on veteran status", 
       y = "Proportion", x = "Voted", 
     subtitle = "Examining relationship between veteran status and voting",
       caption = "0 = Did not Vote, 1 = Voted",
       fill = "Veteran Status") +
  theme_bw()
```

*see geom_text() code inspiration in reference [4]*

# Appendix B

## Backward Selection Output

```{r backward-selection-appendix}
int_only_model <- glm(voted ~ 1,
                     data = elections_red,
                      family = "binomial")

full_model <- glm(voted ~ metro + sex + marst + veteran+ citizen + 
                   hispanic_status + employed + highest_education + 
                   current_student + race + AGE + Election,
                     data = elections_red,
                      family = "binomial")

best_model <- step(full_model, scope=formula(int_only_model), 
                   direction = "backward")

```


## Backward Selection Model Output

```{r tidy model appendix}
tidy(best_model) %>% 
  kable(digits = 3, caption = "Model Resulting From Backward Selection")
```

# Appendix C

## Model Output Including Interaction Terms

**(resulting from first drop-in-deviance test)**

```{r interaction-appendix}
reduced_model <- best_model

full_model <- glm(voted ~ sex + current_student + citizen + employed + 
                    race + marst + Election + AGE + 
                    highest_education +
                    Election*highest_education + 
                    sex*Election + 
                    race*Election,
                     data = elections_red,
                      family = "binomial")

tidy(full_model) %>% 
  kable(digits = 3, caption = "Model Including Interaction Terms")
```

# Appendix D

## Checking Model Conditions for the final model

### Linearity

**Empirical Logit Plot for Quantitative Predictor Variable: Age**

```{r logit-appendix, fig.height=3, fig.width=5}
library(Stat2Data)
emplogitplot1(voted ~ AGE, data = elections_red, 
              ngroups = 10, main = "Empirical Logit Plot For Age")
```

*Consulted reference [11] for the code to add the title to the empirical logit plot*

\newpage

### Independence

**Misclassification rate by region**

```{r fip-new-appendix}
library(maps)
data(state.fips)
joined_fips <- left_join(elections_red, state.fips, by = c("STATEFIP" = "fips"))

model_aug <- augment(voting_model, type.predict = "response") #probability

model_aug <- model_aug %>% 
  mutate(predicted_voted = if_else(.fitted > 0.5, "Will Vote", "Will Not Vote"))

tojoin <- joined_fips %>% 
  select(AGE, region)

aug_fips <- left_join(model_aug, tojoin, by ="AGE")
```

```{r misclassification-rates-by-region-appendix}
aug_fips <- aug_fips %>% 
  mutate(region = case_when(region == 1 ~ "Northeast",
                            region == 2 ~ "Midwest",
                            region == 3 ~ "South",
                            region == 4 ~ "West"))
# used Census data for the region fips number corresponding to region name [3]

missclassification <- aug_fips %>% 
  group_by(region) %>% 
  count(voted, predicted_voted) %>%  
  #all combs of responses specified as arguments
  mutate(prop = n / sum(n)) %>% 
  filter(voted == 1 & predicted_voted == "Will Not Vote" | 
        voted == 0 & predicted_voted == "Will Vote")
missclassification %>% 
  kable(digits = 3, caption = "Missclassification Rates by Region")
```

*Consulted Census data for the region fips number corresponding to region name [3]*

### Checking for influential points

```{r obs-num-final-appendix}
final_best_aug <- augment(voting_model) %>%
   mutate(obs_num = row_number()) #add row number to help with graphing
```

**Cook's distance plot for final model**

```{r Cooks-final-appendix, fig.height=3, fig.width=5}
## scatterplot of Cook's D vs. observation number
ggplot(data = final_best_aug, aes(x = obs_num, y = .cooksd)) +
  geom_point(alpha = 0.7) +
  geom_hline(yintercept = c(0.5,1), color = "red", lty = 2) +
  labs(x = "Observation Number", y = "Cook's D") +
  geom_text(aes(label = ifelse(.hat > 0.5,
                           as.character(obs_num), "")), nudge_x = 1)
```

**Multicollinearity: VIF Table for final model**

```{r VIF-final-appendix}
# load rms package and calculate VIF
library(rms)
vif(voting_model) %>% 
  tidy() %>% 
  arrange(x) %>% 
  kable(digits = 3)
```

